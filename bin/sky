#!/usr/bin/env ruby

$:.unshift(File.join(File.dirname(File.expand_path(__FILE__)), '..', 'lib'))

require 'rubygems'
require 'skydb'
require 'skydb/import'
require 'commander/import'

program :name, 'Sky'
program :version, SkyDB::VERSION
program :description, 'A multi-purpose utilty for the Sky database.'


################################################################################
# Import
################################################################################

command :import do |c|
  c.syntax = 'sky import FILE'
  c.description = 'Imports data from a text file into a Sky table.'
  c.option('--table STRING', 'The name of the table to import to.')
  c.option('--format STRING', 'The YAML format file to import with.')
  c.when_called do|args, options|
    importer = SkyDB::Import::Importer.new()
    importer.table_name = options.table || ask("Table: ")
    importer.format = options.format || ask("Format: ")
    importer.import(args)
  end
end
